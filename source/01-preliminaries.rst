.. role:: math(raw)
   :format: html latex
..

预备知识
========

1. 导论
-------

在进一步学习课程之前，本讲提供一些基础的“预备知识”。宏观经济学既是动态的，又是随机的。动态意味着我们必须时时追踪变量随时间的变化，而随机则意味着我们需要研究预期。因此，本讲将首先介绍一下符号系统及有关预期运算规则。接下来我们将介绍在宏观经济学中用到的随机过程—马尔可夫（
Markov
）过程及ARMA过程。然后我们讨论几个分析工具，这些工具将会在ARMA模型的框架中讨论，但是这些工具会有更广泛的应用，当我们学习经济模型时将会用到它们，如脉冲响应函数及方差分解等。我还将简要讨论一下关于“滤波”的基础知识。滤波是非常重要的，（因为存在趋势问题，）我们只有先把真实世界的数据转换后才能在经济模型的框架内开展分析。本讲最后将介绍卢卡斯批评（Lucas
Critique），卢卡斯批评奠定了现代宏观经济学的基础。

--------------

2. 符号系统与预期
-----------------

变量是某些可以（确定性地或随机地）改变的事物的实现。内生变量是指在模型“内部”决定的变量（即在均衡框架内根据决策规则通过优化问题推导出来的）。外生变量则是由模型“外部”决定的，通常是做为给定的因素。我们根据既定的外生变量，将其代入到模型中，模型运行的结果就是内生变量的实现。参数则是规制模型关系的数值（例如效用函数的曲度如何，决策行为人对未来效用流的折现倾向有多大，等等）。参数通常也被看作是外生且固定的，当然，模型中也可以设定参数为随机改变的，此时参数就变成是外生变量。我将采用拉丁字母（如
:math:`\(X\)` ，\ :math:`\(Y\)`\ ）来表示变量，而用希腊字母（如
:math:`\(\alpha, \beta\)`
）表示参数。我会尽量做到，只是可能偶尔会有些例外。

在描述宏观经济模型的变量时，我们还会遇到“状态”变量和“控制”变量两个术语。外生变量总是状态变量，但是内生变量则既可能是控制变量，也可能是状态变量。大致说来，“控制”变量是指其变量值是在模型中选择的，可以自由“跳跃”以响应新信息。状态变量的变量值则是行为人做决策时所需要的给定值。这些变量即可能是外生的（如一个最常用的术语，政府支出），也可能是内生的（资本存量、资产存量等）。状态变量是根据不同的控制变量要求而预先确定的：为了选择控制变量，需要预先知道状态变量。说到有些状态变量是内生的，是如下意义上的，即行为人当前的行为决策可能会影响未来状态变量的值，但是状态变量的当前值通常是已知的。

宏观经济模型和数据是动态的—我们在某时间点上观测变量的实现值。大多数宏观模型的时间是离散的（某些增长模型和资产定价模型例外）。令
:math:`\(X_t\)`\ 代表变量（可以是内生的也可以是外生的，可以是控制变量也可以是状态变量）。这个符号表示变量在是时间
:math:`\(t\)`\ 的变量实现值。\ :math:`\(X_{t-1}\)`\ 则代表在\ :math:`\(t\)`\ 之前的一期变量实现值。\ :math:`\(X_{t+k}\)`
代表在\ :math:`\(t\)`\ 时期之后第\ :math:`\(k\)`\ 期的变量实现值，依此类推。人们在使用时间标记符号时常常会有些翻来覆去的不一致情况，我也有这种情况（抱歉）。有时候，我们把时期0做为“现在”，然后向前推进时间；则在
:math:`\(t=0,1,2,...\)`\ 时的\ :math:`\(X_t\)`\ 代表的是当前（时期0）和今后的变量的实现值。在名外一些时候，我们用时期
:math:`\(t\)`
来代表现在，如此一来，就只能用\ :math:`\(X_{t+k}\)`\ 来代表时间向后（
:math:`\(k>0\)` ）或向前（ :math:`\(k<0\)` ）推进了。


宏观经济模型是随机的，即变量的实现值具有随机性。宏观模型的随机性本质源于外生变量，我们在建模时通常是将外生变量赋予随机性。由于模型是随机的，且行为人是前瞻性的，因此我们需要考虑预期问题。用\ :math:`\(E(X_t)\)`\ 代表\ :math:`\(X_t\)`\ 的无条件预期。所谓无条件是指行为人对系统的现状一无所知。
:math:`\(E_tX_{t+k}\)`\ 代表对\ :math:`\(X\)`\ 的未来实现值的基于在时间\ :math:`\(t\)`
所能获取的全部信息所做出的\ *条件*\ 预期。习惯上我们有\ :math:`\(E_tX_t = X_t\)`
，这是因为\ :math:`\(X_t\)` 在时期 :math:`\(t\)`
是已知的，其实现值已经没有不确定性。同理，我们还有
:math:`\(E_tX_{t−k} = X_{t−k}\)`.

对于两个任意的随机变量 :math:`\(Y\)` and
:math:`\(Z\)`\ ，根据迭代期望法则，
:math:`\(E(Y ) =E(E(Y | Z))\)`\ 。用文字表达的意思是，条件期望的无条件期望是无条件期望。
对于时间序列其含义如下：\ :math:`\( E_t(E_{t+1}(X_{t+2})) =E_tX_{t+2}\)`\ 。
再用文字表达的意思是，根据今天建立在对明天信息的条件猜想之上对今后两期的变量的条件猜想，恰恰就是基于今天的信息所能做出的最好猜想。（In
other words, your best guess conditional on today’s information of your
best guess conditional on tomorrow’s information of a variable two
periods out from now is just your best guess based on today’s
information.）

理性预期超出了简单的期望值的概念，对预期施加了更多结构性要求，这个领域的贡献要追溯到
Muth 和 Lucas。理性预期告诉我们，相关变量的未来实现值的期望
(i)在平均意义上是正确的； (ii)
在给定信息条件下，预测误差是不可预料的。换句话说，行为人只有在如下意义上才能建模出一致性的预期：（i）他们了解能够产生内生变量的模型并（ii）运用这些信息做出预测。这并不意味着行为人的预测不会出错。令
:math:`\(E_tX_{t+k}\)`
表示在时间\ :math:`\(t\)`\ 根据可用信息做出的此后第\ :math:`\(k\)`\ 期的\ :math:`\(X_t\)`\ 的条件预测。预测误差是\ :math:`\(u_{t+k} = X_{t+k} − E_tX_{t+k}\)`\ ：即实现值减去期望值。一般情况下\ :math:`\(u_{t+k} \)`\ 不会为零，但从平均意义上讲它应该为零，即它的无条件期望应该为零，\ :math:`\(E（u_{t+k}） =0\)`\ 。这背后的逻辑非常简单：如果我们在平均意义上有了预测误差，就无法形成最优的预期。进一步说，预测误差与做出预测时所有已知信息的协方差应该为零，\ :math:`\(\text{cov}（u_{t+k}, Z_t） =0\)`\ ，此处\ :math:`\(Z_t\)`\ 代表在\ :math:`\(t\)`\ 时期任意已知的信息。因此理性预期告诉我们预测在平均意义上是正确的且是不可预料的。换个角度可以在某种程度上将预期理解成“优化”—如果我们的预测在平均上是错误的或是可预料到的错误的（而且是关键的错误），我们就无法形成优化的预期。理性预期在经验研究中受到广泛应用，这意味着在计量经济学的应用中会受到一些限制
。注意，理性预期并不一定排除信息摩擦：我们可以对行为人可获得的信息加以限制
。这可能会导致行为人看起来似乎是违反了理性预期（他们的预测误差是可以预料到的了），但是只有在拥有了超出行为人在做出预测时所拥有的信息的情况下才成立。

--------------

3 随机过程
----------

如上所述，大部分宏观模型都是由对外生变量冲击过程所驱动的。我们需要明确这些外生状态变量所遵循的随机过程的性质。刻画随机过程最常见的两种方式是马尔可夫（Markov）过程
(离散结果)
和自回归移动平均(ARMA)过程。所谓的马尔可夫性质是指，一个系统的现状对于预测该状态的未来值来说是充分统计量。例如，一旦我们知道了\ :math:`\(S_t\)`\ (当前状态)，此时再多了解到:math:`\(S_{t-k}, (k>0)\)`\ 并不能提供更多有关该状态在未来的预期演进。

令\ :math:`\( S ̄\)`
为一些外生变量的可能实现值\ :math:`\(s_t\)`\ 的\ :math:`\( N × 1\)`
阶向量，令\ :math:`\( P\)` 为\ :math:`\( N × N\)`
阶概率矩阵。矩阵的元素是在时期\ :math:`\( t\)` 和\ :math:`\(t+1\)`
之间由状态\ :math:`\(i\)` 到状态\ :math:`\( j\)` 转移的概率。因此，

:math:`\(P_{i，j}=\text{prob}(s_{t+1}=s_j|s_t=s_i)\)`

此处\ :math:`\(i\)` 和 :math:`\(j\)`
是特定的\ :math:`\(\bar S\)`\ 的离散实现值。用文字表达为，矩阵的行（用\ :math:`\(i\)`\ 标示）代表当前状态，列（用\ :math:`\(j\)`\ 标示）则表示站在状态\ :math:`\(i\)`\ 来预期\ :math:`\(t+1\)`\ 期可能出现的每一个可能状态的概率。所有的行合计一定为1，即经济系统在一下期会转换为某个可能的实现值的概率为1。很自然地，对角线上的元素上越大，随机过程越具有持续性。

ARMA
过程是构建在白噪声基础上的连续过程。白噪声过程（用\ :math:`\(\varepsilon_t\)`\ 表示）具有均值为0的特性(\ :math:`\(E(\varepsilon_t)=0\)`)，并且具有已知的且非时变的方差(如
:math:`\(\text{var}(\varepsilon_t)=\sigma^2\)`)，白噪声过程实现值与所有领先项和滞后项之间均不想关
(如
:math:`\(\text{cov}(\varepsilon_t, \varepsilon_{t+j})=0, \forall j\)`
)。

ARMA(p,q) 过程可以写成如下形式

:math:`\(s_t=a+\rho_1s_{t-1}+\rho_2s_{t-2}+…+\rho_ps_{t-p}+\varepsilon_t+\theta_1\varepsilon_{t-1}+\theta_2\varepsilon_{t-2}+…+\theta_q\varepsilon_{t-q}\)`

此处，\ :math:`\(p\)`\ 表示自回归滞后阶（滞后因变量数），\ :math:`\(q\)`
表示移动平均滞后阶（滞后白噪声项数）。ARMA过程并非唯一的—在某种条件下，我们可以在MA过程和AR过程之间反复进行。这意味着我们常常可以用拥有足够多滞后项的纯AR过程来近似MA项。因此，大多数时候我们都可以用持续足够长的AR(p)过程来近似ARMA过程。
AR(p)
过程在形式上并一定具有前文讨论过的马尔可夫性质—已知\ :math:`\(s_t\)`
并不足以预测\ :math:`\(s_{t+1}\)`
，我们还需要知道\ :math:`\(s_{t-1}\)`\ ， :math:`\(s_{t-2}\)` 等等。
但是结果是我们可以重新定义状态变量，将AR(p)
写为VAR(1)(V代表向量)。具体地说，假如我们有如下随机过程（此处忽略常数项）


:math:`\(s_t=\rho_1s_{t-1}+\rho_2s_{t-2}+\rho_3s_{t-3}+…+\rho_ps_{t-p}+\varepsilon_t\)`

那么，我们定义一个向量

.. math::

   s_t=\begin{bmatrix}
     s_t\\
     s_{t-1}\\
     s_{t-2}\\
     \vdots\\
     s_{t-p+1}
   \end{bmatrix}

我们可以将随机过程写为

.. math::

   \begin{bmatrix}
     s_t\\
     s_{t-1}\\
     s_{t-2}\\
     \vdots\\
     s_{t-p+1}
   \end{bmatrix}
   =
   \begin{pmatrix}
   \rho_1&\rho_2&\rho_3&\cdots&\rho_p\\
   1&0&0&\cdots& 0\\
   0&1&0&\cdots& 0\\
   \vdots&\vdots&\vdots&\cdots&\vdots\\
   0&0&0&\cdots& 0
   \end{pmatrix}
   \begin{bmatrix}
     s_{t-1}\\
     s_{t-2}\\
     s_{t-3}\\
     \vdots\\
     s_{t-p}
   \end{bmatrix}
   +
   \begin{bmatrix}
     \varepsilon_t\\
     0\\
     0\\
     \vdots\\
     0
   \end{bmatrix}

或者简单写成

:math:`\(s_t=\Lambda s_{t-1}+\varepsilon_t\)`

此处\ :math:`\(\Lambda\)`\ 代表前述矩阵的系数矩阵。将状态变量如此重新定义后，该过程就具有了马尔可夫性质。我们将会看到，拥有AR(1)的结构使得计算脉冲响应和方差分解都变得相当简易直接了。

--------------

4. 脉冲响应函数和方差分解
-------------------------

脉冲响应函数被定义为变量（或变量的向量）的当前值与预期值对某一时点上冲击的实现值的反应而发生的变动。我们把冲击看作是外生变量的创新（或意外变动），这里的创新被刻画为白噪声。这个定久不依赖于外生变量或内生变量的任何特定过程。假定\ :math:`\(X_t\)`
是某种构建白噪声的单变量过程，脉冲响应函数就可以定义为：

.. math:: \text{IRF}(h)=E_tX_{t+h}-E_{t-1}X_{t+h}|\varepsilon_t=e, h\geq 0

此处\ :math:`\(e\)`
是\ :math:`\(\varepsilon_t\)`\ 的某一特定的实现值。常见的是计算对标准差冲击的脉冲响应函数，即在\ :math:`\(e=\sigma\)`\ 时（\ :math:`\(\sigma\)`\ 代表\ :math:`\(\varepsilon_t\)`\ 的标准差
）。但是我们可以计算任意大小（或符号）的冲击的脉冲响应函数。如果过程是线性的，这没关系，脉冲响应函数并不依赖于冲击的大小（除了上下响应的幅度），符号也只会影响响应的符号。对于非线性过程，情况会不太一样。

下面是一个AR(1)过程的例子：

.. math:: X_t=0.9X_{t-1}+\varepsilon_t

假设\ :math:`\(\varepsilon_t \~ N(0,1)\)`\ ，则可以利用这个过程来计算其期望值以计算脉冲响应函数。在时间\ :math:`\(t-1\)`
，\ :math:`\(\varepsilon_t\)`\ 的期望值是0，因此有

.. math::

   \begin{eqnarray}\\
   E_{t-1}X_t&=&0.9X_{t-1}\\
   E_{t-1}X_{t+1}&=&0.9^2X_{t-1}\\
   E_{t-1}X_{t+2}&=&0.9^3X_{t-1}\\
   &\vdots \\
   E_{t-1}X_{t+h}&=&0.9^{h+1}X_{t-1}
   \end{eqnarray}


现在，我们计算在时间\ :math:`t`\ 时冲击的实现值为1（等于标准差）时的期望值：

.. math::

   \begin{eqnarray}\\
   E_{t}X_t&=&0.9X_{t-1}+1\\
   E_{t}X_{t+1}&=&0.9^2X_{t-1}+0.9\\
   E_{t}X_{t+2}&=&0.9^3X_{t-1}+0.81\\
   &\vdots \\
   E_{t}X_{t+h}&=&0.9^{h}X_{t-1}
   \end{eqnarray}

对这两个结果做差分

.. math::

   \begin{eqnarray}\\
   E_{t}X_t-E_{t-1}X_{t}&=1\\
   E_{t}X_{t+1}-E_{t-1}X_{t+1}&=0.9\\
   E_{t}X_{t+2}-E_{t-1}X_{t+2}&=0.81\\
   &\vdots \\
   E_{t}X_{t+h}-E_{t-1}X_{t+h}&=0.9^h
   \end{eqnarray}

以上我们演示了一个关于外生变量的脉冲响应函数，我们也可以对内生变量\ :math:`\(Y_t\)`\ 做如此处理。假设\ :math:`\(Y_t\)`\ 以某种方式依存于\ :math:`\(X_t\)`\ ，比较简单的是假设这种依存关系为线性的，如\ :math:`\(Y_t=\beta X_t\)`
。我们用同样的方式进行构建\ :math:`\(Y_t\)`\ 的IRF—计算在时间\ :math:`\(t\)`
冲击实现值的条件下的预测，将其与没有这个实现值时的预测进行比较。在本例中，\ :math:`\(Y_t\)`\ 的脉冲响应只是\ :math:`\(X_t\)`
的脉冲响应的一个比例（比例为\ :math:`\(\beta\)`\ ）

较为常见的做法是将脉冲反应画出图来以做为分析的方式。对于这一过程，我们有如下脉冲图：

.. figure:: /figures/sim0101.png
   :alt: 

脉冲响应函数在本质上只是一个系数时间序列的移动平均的描点图。继续用前文AR(1)的例子，为了获得移动平均的表达式，做如下迭代

.. math::

   \begin{eqnarray}
   X_t=0.9X_{t-1}+\varepsilon_t\\
   X_t=0.9(0.9X_{t-2}+\varepsilon_{t-1})+\varepsilon_t=0.81X_{t-2}+0.9\varepsilon_{t-1}+\varepsilon_t\\
   X_t=0.81(0.9X_{t-3}+\varepsilon_{t-2})+0.9\varepsilon_{t-1}+\varepsilon_t=0.9^3X_{t-3}+0.81\varepsilon_{t-2}+0.9\varepsilon_{t-1}+\varepsilon_t
   \end{eqnarray}

如果我们不断这样迭代下去，由于当\ :math:`\(k\)`\ 足够大时，\ :math:`\(0.9^k \to 0\)`\ ，所以我们得到

.. math:: X_t=\varepsilon_t+0.9\varepsilon_{t-1}+0.81\varepsilon_{t-2}+0.9^3\varepsilon_{t-3}+\cdots

或者以求和符号的形式写为：

.. math:: X_t=\sum_{j=0}^\infty 0.9^j \varepsilon_{t-j}

将此与前文对比，我们看到脉冲响应函数只是移动平均“向前移动”的表达式。为了表明这一点，我们把前文所做按着取前向期望的方式再做一遍

.. math::

   \begin{eqnarray}
   E_{t-1}X_t=0.9\varepsilon_{t-1}+0.81\varepsilon_{t-2}+0.9^3\varepsilon_{t-3}+\cdots\\
   E_{t-1}X_{t+1}=0.81\varepsilon_{t-1}+0.9^3\varepsilon_{t-2}+\cdots\\
   E_{t-1}X_{t+2}=0.9^3\varepsilon_{t-1}+0.9^4\varepsilon_{t-2}+\cdots
   \end{eqnarray}

此处\ :math:`\(\varepsilon_t\)`\ 项没有出现，这是因为\ :math:`\(E_{t-1}\varepsilon_t=0\)`\ 。现在我们设定时期t的\ :math:`\(\varepsilon_t\)`\ 的实现值为1的前提下再做一遍（像前文做过的那样）

.. math::

   \begin{eqnarray}
   E_{t}X_t=1+0.9\varepsilon_{t-1}+0.81\varepsilon_{t-2}+0.9^3\varepsilon_{t-3}+\cdots\\
   E_{t}X_{t+1}=0.9+0.81\varepsilon_{t-1}+0.9^3\varepsilon_{t-2}+\cdots\\
   E_{t}X_{t+2}=0.81+0.9^3\varepsilon_{t-1}+0.9^4\varepsilon_{t-2}+\cdots
   \end{eqnarray}

然后取两者之差构建脉冲反应函数：

.. math::

   \begin{eqnarray}\\
   E_{t}X_t-E_{t-1}X_{t}&=1\\
   E_{t}X_{t+1}-E_{t-1}X_{t+1}&=0.9\\
   E_{t}X_{t+2}-E_{t-1}X_{t+2}&=0.81\\
   &\vdots \\
   E_{t}X_{t+h}-E_{t-1}X_{t+h}&=0.9^h
   \end{eqnarray}

这与前文的情况完全相同。换句话说，h级脉冲响应就是滞后h级的MA的系数。从根本上说，我们在宏观中通常感兴趣的正是这个移动平均的表达，它告诉了我们初始的冲击（\ :math:`\(\varepsilon\)`\ ）会如何在不同层级上影响变量。估计和处理移动平均项是很难的（由于\ :math:`\(\varepsilon\)`\ 是直接观测到的，所以需要分布假设和最大似然估计）。估计和处理AR(p)过程则相对直接些—大多数情况下，最小二乘法（OLS）就是估计这类过程的具有一致性的估计方法。因此这表明我们可以通过估计AR模型并构建脉冲响应函数来获得时间序列的移动平均表达—不同层级（不同的h）的脉冲响应函数的系数就是同样滞后级的移动平均的系数。

当然，我上面所做的隐含地假设了可以由AR过程获取移动平均的表达。有时候这是不太可能的，这种情况我们称之为不可逆AR过程。在多变量的框架下，会有些有趣的经济机制会引起经济模型中出现这种情况。如无特别提醒可以不必对此过分担心。另外，在我们上面的处理过程中，我们是假设了一个简单的AR(1)过程，这个在构建脉冲响应的机制技巧上就相当简单。我们的随机过程可能会复杂得多，但脉冲响应函数的的一般性定义还是同样的。AR(p)过程可能看起来相当棘手，难以用手算出其脉冲响应函数，但是，如果我们还记得的话，前面我们说过可以将AR(p)过程写成VAR(1)，这使得\ :math:`h`
